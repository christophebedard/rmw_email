<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="784px" preserveAspectRatio="none" style="width:2078px;height:784px;" version="1.1" viewBox="0 0 2078 784" width="2078px" zoomAndPan="magnify"><defs><filter height="300%" id="fmprrd3w2kivd" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class EmailSender--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="57.5781" id="EmailSender" style="stroke: #A80036; stroke-width: 1.5;" width="384" x="1447.5" y="326"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="1600.5" y="342.1387">EmailSender</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1448.5" x2="1830.5" y1="349.9688" y2="349.9688"/><ellipse cx="1458.5" cy="361.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="291" x="1467.5" y="364.1792">send(EmailContent, optional&lt;EmailHeaders&gt;): bool</text><ellipse cx="1458.5" cy="374.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="358" x="1467.5" y="376.9839">reply(EmailContent, EmailData, optional&lt;EmailHeaders&gt;): bool</text><!--class EmailReceiver--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="57.5781" id="EmailReceiver" style="stroke: #A80036; stroke-width: 1.5;" width="374" x="630.5" y="8"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="86" x="774.5" y="24.1387">EmailReceiver</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="631.5" x2="1003.5" y1="31.9688" y2="31.9688"/><ellipse cx="641.5" cy="43.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="348" x="650.5" y="46.1792">get_email(nanoseconds polling_period): optional&lt;EmailData&gt;</text><ellipse cx="641.5" cy="56.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="650.5" y="58.9839">shutdown()</text><!--class PollingManager--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="116.7969" id="PollingManager" style="stroke: #A80036; stroke-width: 1.5;" width="292" x="671.5" y="126"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="769.5" y="142.1387">PollingManager</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="672.5" x2="962.5" y1="149.9688" y2="149.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="679.5" y="158.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="691.5" y="164.1792">thread</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="672.5" x2="962.5" y1="170.7734" y2="170.7734"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="679.5" y="179.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="266" x="691.5" y="184.9839">handlers: vector&lt;function&lt;void (EmailData)&gt;&gt;</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="679.5" y="192.4805"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="691.5" y="197.7886">poll_thread()</text><ellipse cx="682.5" cy="208.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="691.5" y="210.5933">start()</text><ellipse cx="682.5" cy="221.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="691.5" y="223.3979">shutdown()</text><ellipse cx="682.5" cy="233.8945" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="257" x="691.5" y="236.2026">register_handler(function&lt;void (EmailData)&gt;)</text><!--class EmailHandler--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="44.7734" id="EmailHandler" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="320" y="162"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="82" x="343.5" y="178.1387">EmailHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="321" x2="448" y1="185.9688" y2="185.9688"/><ellipse cx="331" cy="197.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="340" y="200.1792">handle(EmailData)</text><!--class SubscriptionHandler--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="78.3828" id="SubscriptionHandler" style="stroke: #A80036; stroke-width: 1.5;" width="569" x="6" y="316"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="127" x="227" y="332.1387">SubscriptionHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="574" y1="339.9688" y2="339.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="14" y="348.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="375" x="26" y="354.1792">subscriptions: map&lt;string, queue&lt;pair&lt;string, MessageInfo&gt;&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="574" y1="360.7734" y2="360.7734"/><ellipse cx="17" cy="372.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="543" x="26" y="374.9839">register_subscription(string topic_name, queue&lt;pair&lt;string, MessageInfo&gt;&gt; message_queue)</text><ellipse cx="17" cy="385.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="26" y="387.7886">handle(EmailData)</text><!--class ServiceHandler--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="103.9922" id="ServiceHandler" style="stroke: #A80036; stroke-width: 1.5;" width="603" x="610" y="303"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="864.5" y="319.1387">ServiceHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="611" x2="1212" y1="326.9688" y2="326.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="618" y="335.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="546" x="630" y="341.1792">clients: map&lt;GidValue, shared_ptr&lt;map&lt;SequenceNumber, pair&lt;EmailData, ServiceInfo&gt;&gt;&gt;&gt;</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="618" y="348.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="437" x="630" y="353.9839">servers: map&lt;string, shared_ptr&lt;queue&lt;pair&lt;EmailData, ServiceInfo&gt;&gt;&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="611" x2="1212" y1="360.5781" y2="360.5781"/><ellipse cx="621" cy="372.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="572" x="630" y="374.7886">register_service_client(Gid, map&lt;SequenceNumber, pair&lt;EmailData, ServiceInfo&gt;&gt; response_map)</text><ellipse cx="621" cy="385.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="577" x="630" y="387.5933">register_service_server(string service_name, queue&lt;pair&lt;EmailData, ServiceInfo&gt;&gt; request_queue)</text><ellipse cx="621" cy="398.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="630" y="400.3979">handle(EmailData)</text><!--class GidObject--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="65.5781" id="GidObject" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="1790.5" y="151.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="1811.5" y="167.6387">GidObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1791.5" x2="1891.5" y1="175.4688" y2="175.4688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1798.5" y="184.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="44" x="1810.5" y="189.6792">gid: Gid</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1791.5" x2="1891.5" y1="196.2734" y2="196.2734"/><ellipse cx="1801.5" cy="208.1758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="1810.5" y="210.4839">get_gid(): Gid</text><!--class NamedObject--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="78.3828" id="NamedObject" style="stroke: #A80036; stroke-width: 1.5;" width="171" x="1358" y="145.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="1401.5" y="161.6387">NamedObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1359" x2="1528" y1="169.4688" y2="169.4688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1366" y="178.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="1378" y="183.6792">object_name: string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1359" x2="1528" y1="190.2734" y2="190.2734"/><polygon fill="#FFFF44" points="1369,197.1758,1373,201.1758,1369,205.1758,1365,201.1758" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="1378" y="204.4839">get_object_name(): string</text><polygon fill="#FFFF44" points="1369,209.9805,1373,213.9805,1369,217.9805,1365,213.9805" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="91" x="1378" y="217.2886">validate_name()</text><!--class PubSubObject--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="57.5781" id="PubSubObject" style="stroke: #A80036; stroke-width: 1.5;" width="164" x="1248.5" y="326"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="88" x="1286.5" y="342.1387">PubSubObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1249.5" x2="1411.5" y1="349.9688" y2="349.9688"/><ellipse cx="1259.5" cy="361.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="1268.5" y="364.1792">get_topic_name(): string</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1256.5" y="371.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="91" x="1268.5" y="376.9839">validate_name()</text><!--class ServiceObject--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="57.5781" id="ServiceObject" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="1866.5" y="326"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="1913" y="342.1387">ServiceObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1867.5" x2="2043.5" y1="349.9688" y2="349.9688"/><ellipse cx="1877.5" cy="361.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="1886.5" y="364.1792">get_service_name(): string</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1874.5" y="371.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="91" x="1886.5" y="376.9839">validate_name()</text><!--class Publisher--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="44.7734" id="Publisher" style="stroke: #A80036; stroke-width: 1.5;" width="427" x="1117" y="496.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="58" x="1301.5" y="512.6387">Publisher</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1118" x2="1543" y1="520.4688" y2="520.4688"/><ellipse cx="1128" cy="532.3711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="401" x="1137" y="534.6792">publish(string message, optional&lt;EmailHeaders&gt; additional_headers)</text><!--class Subscription--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="91.1875" id="Subscription" style="stroke: #A80036; stroke-width: 1.5;" width="391" x="691" y="473.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="847.5" y="489.6387">Subscription</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="692" x2="1081" y1="497.4688" y2="497.4688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="699" y="506.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="274" x="711" y="511.6792">messages: queue&lt;pair&lt;string, MessageInfo&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="692" x2="1081" y1="518.2734" y2="518.2734"/><ellipse cx="702" cy="530.1758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="711" y="532.4839">has_message(): bool</text><ellipse cx="702" cy="542.9805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="711" y="545.2886">get_message(): optional&lt;string&gt;</text><ellipse cx="702" cy="555.7852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="365" x="711" y="558.0933">get_message_with_info(): optional&lt;pair&lt;string, MessageInfo&gt;&gt;</text><!--class ServiceClient--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="142.4063" id="ServiceClient" style="stroke: #A80036; stroke-width: 1.5;" width="509" x="1076" y="631"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80" x="1290.5" y="647.1387">ServiceClient</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="1584" y1="654.9688" y2="654.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1084" y="663.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="389" x="1096" y="669.1792">responses: map&lt;SequenceNumber, pair&lt;EmailData, ServiceInfo&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="1584" y1="675.7734" y2="675.7734"/><ellipse cx="1087" cy="687.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="301" x="1096" y="689.9839">send_request(string request, SequenceNumber seq)</text><ellipse cx="1087" cy="700.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="239" x="1096" y="702.7886">send_request(request): SequenceNumber</text><ellipse cx="1087" cy="713.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="1096" y="715.5933">has_response(SequenceNumber seq): bool</text><ellipse cx="1087" cy="726.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="1096" y="728.3979">has_response(): bool</text><ellipse cx="1087" cy="738.8945" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="316" x="1096" y="741.2026">get_response(SequenceNumber seq): optional&lt;string&gt;</text><ellipse cx="1087" cy="751.6992" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="483" x="1096" y="754.0073">get_response_with_info(SequenceNumber seq): optional&lt;pair&lt;string, ServiceInfo&gt;&gt;</text><ellipse cx="1087" cy="764.5039" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="357" x="1096" y="766.812">get_response_with_info(): optional&lt;pair&lt;string, ServiceInfo&gt;&gt;</text><!--class ServiceServer--><rect fill="#FEFECE" filter="url(#fmprrd3w2kivd)" height="103.9922" id="ServiceServer" style="stroke: #A80036; stroke-width: 1.5;" width="428" x="1579.5" y="467"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="1751" y="483.1387">ServiceServer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1580.5" x2="2006.5" y1="490.9688" y2="490.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1587.5" y="499.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="280" x="1599.5" y="505.1792">requests: queue&lt;pair&lt;EmailData, ServiceInfo&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1580.5" x2="2006.5" y1="511.7734" y2="511.7734"/><ellipse cx="1590.5" cy="523.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="1599.5" y="525.9839">has_request(): bool</text><ellipse cx="1590.5" cy="536.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="235" x="1599.5" y="538.7886">get_request(): optional&lt;ServiceRequest&gt;</text><ellipse cx="1590.5" cy="549.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="402" x="1599.5" y="551.5933">get_request_with_info(): optional&lt;pair&lt;ServiceRequest, ServiceInfo&gt;&gt;</text><ellipse cx="1590.5" cy="562.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="357" x="1599.5" y="564.3979">send_response(ServiceRequestId request_id, string response)</text><!--link EmailReceiver to PollingManager--><path d="M817.5,79.18 C817.5,93.64 817.5,110.16 817.5,125.72 " fill="none" id="EmailReceiver-PollingManager" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="817.5,66.05,813.5,72.05,817.5,78.05,821.5,72.05,817.5,66.05" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailHandler to SubscriptionHandler--><path d="M362.53,224.88 C347.26,252.26 327.01,288.55 311.87,315.69 " fill="none" id="EmailHandler-SubscriptionHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="356.55,221.24,372.4,207.18,368.77,228.06,356.55,221.24" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PollingManager to SubscriptionHandler--><path d="M666.54,233.77 C584.88,259.88 485.46,291.66 409.36,316 " fill="none" id="PollingManager-SubscriptionHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="671.4,232.21,661.6107,231.1283,666.6356,233.7266,664.0373,238.7514,671.4,232.21" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="578.4434" y="230.9803">registers with</text><!--link EmailHandler to ServiceHandler--><path d="M468.55,212.37 C544.55,236.67 658.5,273.11 751.8,302.94 " fill="none" id="EmailHandler-ServiceHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="466.04,218.92,449.12,206.16,470.3,205.58,466.04,218.92" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PollingManager to ServiceHandler--><path d="M852.15,247.61 C862.31,265.82 873.29,285.51 883.02,302.95 " fill="none" id="PollingManager-ServiceHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="849.59,243.02,850.4886,252.8278,852.0291,247.3847,857.4722,248.9252,849.59,243.02" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="763.3863" y="262.7399">registers with</text><!--link GidObject to PubSubObject--><path d="M1770.73,201.16 C1687.52,220.61 1545.98,256.91 1429.5,303 C1413.05,309.51 1395.71,317.88 1380.22,325.95 " fill="none" id="GidObject-PubSubObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1769.27,194.32,1790.33,196.65,1772.41,207.96,1769.27,194.32" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NamedObject to PubSubObject--><path d="M1406.49,240.69 C1387.38,269.18 1364.88,302.73 1349.35,325.89 " fill="none" id="NamedObject-PubSubObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1400.91,236.45,1417.86,223.74,1412.53,244.24,1400.91,236.45" style="stroke: #A80036; stroke-width: 1.0;"/><!--link GidObject to ServiceObject--><path d="M1874.69,234.56 C1894.79,264.27 1919.71,301.1 1936.52,325.95 " fill="none" id="GidObject-ServiceObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1868.62,238.08,1863.21,217.59,1880.22,230.23,1868.62,238.08" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NamedObject to ServiceObject--><path d="M1548.72,210.8 C1631.63,231.96 1749.5,264.78 1849.5,303 C1866.76,309.6 1885.07,317.91 1901.52,325.89 " fill="none" id="NamedObject-ServiceObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1546.9,217.56,1529.22,205.88,1550.33,203.99,1546.9,217.56" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PubSubObject to Publisher--><path d="M1330.5,404.38 C1330.5,434.93 1330.5,472.93 1330.5,496.32 " fill="none" id="PubSubObject-Publisher" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1323.5,404.22,1330.5,384.22,1337.5,404.22,1323.5,404.22" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailSender to Publisher--><path d="M1574.21,390.23 C1513.15,422.24 1423.79,469.09 1371.95,496.27 " fill="none" id="EmailSender-Publisher" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="1586.03,384.03,1578.8584,383.2764,1575.4044,389.6065,1582.576,390.3601,1586.03,384.03" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PubSubObject to Subscription--><path d="M1261.37,393.05 C1251.14,398 1240.63,402.81 1230.5,407 C1170.18,431.93 1102.1,454.92 1042.52,473.44 " fill="none" id="PubSubObject-Subscription" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1258.32,386.75,1279.34,384.07,1264.57,399.27,1258.32,386.75" style="stroke: #A80036; stroke-width: 1.0;"/><!--link SubscriptionHandler to Subscription--><path d="M435.51,395.41 C522.29,419 632.82,449.05 722.74,473.49 " fill="none" id="SubscriptionHandler-Subscription" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="430.61,394.08,438.2388,400.309,435.4335,395.3968,440.3457,392.5914,430.61,394.08" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="362.9968" y="414.4217">registers with</text><!--link ServiceObject to ServiceClient--><path d="M1992.14,400.26 C2026.39,447.28 2066.59,521.51 2025.5,571 C1969.53,638.41 1759.88,671.06 1585.34,686.76 " fill="none" id="ServiceObject-ServiceClient" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1986.5,404.42,1979.95,384.27,1997.64,395.93,1986.5,404.42" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Publisher to ServiceClient--><path d="M1330.5,554.87 C1330.5,576.35 1330.5,604.66 1330.5,630.64 " fill="none" id="Publisher-ServiceClient" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1330.5,541.83,1326.5,547.83,1330.5,553.83,1334.5,547.83,1330.5,541.83" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServiceHandler to ServiceClient--><path d="M734.39,409.79 C710.24,424.56 688.6,443.29 673.5,467 C648.67,505.98 644.16,535.28 673.5,571 C724.75,633.39 913.74,666.34 1075.95,683.44 " fill="none" id="ServiceHandler-ServiceClient" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="738.92,407.08,729.1428,408.2661,734.6288,409.6462,733.2487,415.1321,738.92,407.08" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="625.0186" y="427.1624">registers with</text><!--link ServiceObject to ServiceServer--><path d="M1912.94,398.56 C1892,419.5 1866.6,444.9 1844.61,466.89 " fill="none" id="ServiceObject-ServiceServer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1908.19,393.41,1927.28,384.22,1918.09,403.31,1908.19,393.41" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailSender to ServiceServer--><path d="M1675.4,393.77 C1696.1,415.54 1722.39,443.2 1744.91,466.89 " fill="none" id="EmailSender-ServiceServer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="1666.32,384.22,1667.5525,391.325,1674.585,392.92,1673.3525,385.815,1666.32,384.22" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServiceHandler to ServiceServer--><path d="M1218.57,405.38 C1327.11,423.64 1449.93,445.22 1561.5,467 C1567.37,468.15 1573.32,469.32 1579.32,470.53 " fill="none" id="ServiceHandler-ServiceServer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1213.41,404.51,1221.6223,409.9467,1218.3408,405.3389,1222.9486,402.0575,1213.41,404.51" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="1219.7152" y="403.7126">registers with</text><!--
@startuml

hide empty attributes
hide empty methods
hide circle


class EmailSender {
   +send(EmailContent, optional<EmailHeaders>): bool {abstract}
   +reply(EmailContent, EmailData, optional<EmailHeaders>): bool {abstract}
}

class EmailReceiver {
   +get_email(nanoseconds polling_period): optional<EmailData> {abstract}
   +shutdown()
}


class PollingManager {
   -thread
   -handlers: vector<function<void (EmailData)>>
   -poll_thread()
   +start()
   +shutdown()
   +register_handler(function<void (EmailData)>)
}
EmailReceiver o- - PollingManager

abstract class EmailHandler {
   +handle(EmailData) {abstract}
}


class SubscriptionHandler {
   -subscriptions: map<string, queue<pair<string, MessageInfo>>>
   +register_subscription(string topic_name, queue<pair<string, MessageInfo>> message_queue)
   +handle(EmailData) {abstract}
}
EmailHandler <|- - SubscriptionHandler
PollingManager "registers with" <- - SubscriptionHandler

class ServiceHandler {
   -clients: map<GidValue, shared_ptr<map<SequenceNumber, pair<EmailData, ServiceInfo>>>>
   -servers: map<string, shared_ptr<queue<pair<EmailData, ServiceInfo>>>>
   +register_service_client(Gid, map<SequenceNumber, pair<EmailData, ServiceInfo>> response_map)
   +register_service_server(string service_name, queue<pair<EmailData, ServiceInfo>> request_queue)
   +handle(EmailData) {abstract}
}
EmailHandler <|- - ServiceHandler
PollingManager "registers with" <- - ServiceHandler


class GidObject {
   -gid: Gid
   +get_gid(): Gid
}
class NamedObject {
   -object_name: string
   #get_object_name(): string
   #validate_name() {abstract}
}

class PubSubObject {
   +get_topic_name(): string
   -validate_name() {abstract}
}
GidObject <|- - PubSubObject
NamedObject <|- - PubSubObject

class ServiceObject {
   +get_service_name(): string
   -validate_name() {abstract}
}
GidObject <|- - ServiceObject
NamedObject <|- - ServiceObject


class Publisher {
   +publish(string message, optional<EmailHeaders> additional_headers)
}
PubSubObject <|- - Publisher
EmailSender o- - Publisher

class Subscription {
   -messages: queue<pair<string, MessageInfo>>
   +has_message(): bool
   +get_message(): optional<string>
   +get_message_with_info(): optional<pair<string, MessageInfo>>
}
PubSubObject <|- - Subscription
SubscriptionHandler "registers with" <- - Subscription


class ServiceClient {
   -responses: map<SequenceNumber, pair<EmailData, ServiceInfo>>
   +send_request(string request, SequenceNumber seq)
   +send_request(request): SequenceNumber
   +has_response(SequenceNumber seq): bool
   +has_response(): bool
   +get_response(SequenceNumber seq): optional<string>
   +get_response_with_info(SequenceNumber seq): optional<pair<string, ServiceInfo>>
   +get_response_with_info(): optional<pair<string, ServiceInfo>>
}
ServiceObject <|- - ServiceClient
Publisher *- - ServiceClient
ServiceHandler "registers with" <- - ServiceClient

class ServiceServer {
   -requests: queue<pair<EmailData, ServiceInfo>>
   +has_request(): bool
   +get_request(): optional<ServiceRequest>
   +get_request_with_info(): optional<pair<ServiceRequest, ServiceInfo>>
   +send_response(ServiceRequestId request_id, string response)
}
ServiceObject <|- - ServiceServer
EmailSender o- - ServiceServer
ServiceHandler "registers with" <- - ServiceServer

@enduml

PlantUML version 1.2018.13(Mon Nov 26 17:11:51 UTC 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.11+9
Operating System: Linux
OS Version: 5.8.0-1039-azure
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>