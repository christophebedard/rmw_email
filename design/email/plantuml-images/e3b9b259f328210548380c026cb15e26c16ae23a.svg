<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1049px" preserveAspectRatio="none" style="width:2155px;height:1049px;" version="1.1" viewBox="0 0 2155 1049" width="2155px" zoomAndPan="magnify"><defs><filter height="300%" id="f1gdedjht3erou" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class CurlContext--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="83.1875" id="CurlContext" style="stroke: #A80036; stroke-width: 1.5;" width="143" x="986" y="8"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="1021.5" y="24.1387">CurlContext</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="987" x2="1128" y1="31.9688" y2="31.9688"/><ellipse cx="997" cy="43.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="25" x="1006" y="46.1792">init()</text><ellipse cx="997" cy="56.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="25" x="1006" y="58.9839">fini()</text><ellipse cx="997" cy="69.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="1006" y="71.7886">get_handle(): CURL *</text><ellipse cx="997" cy="82.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="52" x="1006" y="84.5933">execute()</text><!--class CurlExecutor--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="57.5781" id="CurlExecutor" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="1008.5" y="151"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="79" x="1018" y="167.1387">CurlExecutor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1009.5" x2="1105.5" y1="174.9688" y2="174.9688"/><ellipse cx="1019.5" cy="186.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="25" x="1028.5" y="189.1792">init()</text><polygon fill="#FFFF44" points="1019.5,194.6758,1023.5,198.6758,1019.5,202.6758,1015.5,198.6758" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="72" x="1028.5" y="201.9839">init_options()</text><!--class EmailSender--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="70.3828" id="EmailSender" style="stroke: #A80036; stroke-width: 1.5;" width="352" x="549.5" y="602"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="686.5" y="618.1387">EmailSender</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="550.5" x2="900.5" y1="625.9688" y2="625.9688"/><ellipse cx="560.5" cy="637.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="569.5" y="640.1792">send(EmailContent, optional&lt;EmailHeaders&gt;)</text><ellipse cx="560.5" cy="650.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="326" x="569.5" y="652.9839">reply(EmailContent, EmailData, optional&lt;EmailHeaders&gt;)</text><polygon fill="#FFFF44" points="560.5,658.4805,564.5,662.4805,560.5,666.4805,556.5,662.4805" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="72" x="569.5" y="665.7886">init_options()</text><!--class EmailReceiver--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="95.9922" id="EmailReceiver" style="stroke: #A80036; stroke-width: 1.5;" width="549" x="905" y="269"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="86" x="1136.5" y="285.1387">EmailReceiver</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="906" x2="1453" y1="292.9688" y2="292.9688"/><ellipse cx="916" cy="304.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="925" y="307.1792">get_email(): optional&lt;EmailData&gt;</text><polygon fill="#FFFF44" points="916,312.6758,920,316.6758,916,320.6758,912,316.6758" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="72" x="925" y="319.9839">init_options()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="913" y="327.4805"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="925" y="332.7886">get_nextuid(): optional&lt;int&gt;</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="913" y="340.2852"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="925" y="345.5933">get_email_from_uid(int): optional&lt;EmailData&gt;</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="913" y="353.0898"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="523" x="925" y="358.3979">execute(optional&lt;string&gt;, url_options, optional&lt;string&gt; custom_request): optional&lt;string&gt;</text><!--class PollingManager--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="116.7969" id="PollingManager" style="stroke: #A80036; stroke-width: 1.5;" width="292" x="1075.5" y="425"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="1173.5" y="441.1387">PollingManager</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1076.5" x2="1366.5" y1="448.9688" y2="448.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1083.5" y="457.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="1095.5" y="463.1792">thread</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1076.5" x2="1366.5" y1="469.7734" y2="469.7734"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1083.5" y="478.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="266" x="1095.5" y="483.9839">handlers: vector&lt;function&lt;void (EmailData)&gt;&gt;</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1083.5" y="491.4805"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="1095.5" y="496.7886">poll_thread()</text><ellipse cx="1086.5" cy="507.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="1095.5" y="509.5933">start()</text><ellipse cx="1086.5" cy="520.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="1095.5" y="522.3979">shutdown()</text><ellipse cx="1086.5" cy="532.8945" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="257" x="1095.5" y="535.2026">register_handler(function&lt;void (EmailData)&gt;)</text><!--class EmailHandler--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="44.7734" id="EmailHandler" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="1590" y="461"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="82" x="1613.5" y="477.1387">EmailHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1591" x2="1718" y1="484.9688" y2="484.9688"/><ellipse cx="1601" cy="496.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="1610" y="499.1792">handle(EmailData)</text><!--class SubscriptionHandler--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="57.5781" id="SubscriptionHandler" style="stroke: #A80036; stroke-width: 1.5;" width="569" x="937" y="608"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="127" x="1158" y="624.1387">SubscriptionHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="938" x2="1505" y1="631.9688" y2="631.9688"/><ellipse cx="948" cy="643.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="543" x="957" y="646.1792">register_subscription(string topic_name, queue&lt;pair&lt;string, MessageInfo&gt;&gt; message_queue)</text><ellipse cx="948" cy="656.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="957" y="658.9839">handle(EmailData)</text><!--class ServiceHandler--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="70.3828" id="ServiceHandler" style="stroke: #A80036; stroke-width: 1.5;" width="603" x="1541" y="602"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="1795.5" y="618.1387">ServiceHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1542" x2="2143" y1="625.9688" y2="625.9688"/><ellipse cx="1552" cy="637.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="572" x="1561" y="640.1792">register_service_client(Gid, map&lt;SequenceNumber, pair&lt;EmailData, ServiceInfo&gt;&gt; response_map)</text><ellipse cx="1552" cy="650.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="577" x="1561" y="652.9839">register_service_server(string service_name, queue&lt;pair&lt;EmailData, ServiceInfo&gt;&gt; request_queue)</text><ellipse cx="1552" cy="663.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="1561" y="665.7886">handle(EmailData)</text><!--class GidObject--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="65.5781" id="GidObject" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="177.5" y="450.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="198.5" y="466.6387">GidObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="178.5" x2="278.5" y1="474.4688" y2="474.4688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="185.5" y="483.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="44" x="197.5" y="488.6792">gid: Gid</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="178.5" x2="278.5" y1="495.2734" y2="495.2734"/><ellipse cx="188.5" cy="507.1758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="197.5" y="509.4839">get_gid(): Gid</text><!--class NamedObject--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="78.3828" id="NamedObject" style="stroke: #A80036; stroke-width: 1.5;" width="171" x="323" y="444.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="366.5" y="460.6387">NamedObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="324" x2="493" y1="468.4688" y2="468.4688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="331" y="477.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="343" y="482.6792">object_name: string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="324" x2="493" y1="489.2734" y2="489.2734"/><polygon fill="#FFFF44" points="334,496.1758,338,500.1758,334,504.1758,330,500.1758" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="343" y="503.4839">get_object_name(): string</text><polygon fill="#FFFF44" points="334,508.9805,338,512.9805,334,516.9805,330,512.9805" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="91" x="343" y="516.2886">validate_name()</text><!--class PubSubObject--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="57.5781" id="PubSubObject" style="stroke: #A80036; stroke-width: 1.5;" width="164" x="137.5" y="608"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="88" x="175.5" y="624.1387">PubSubObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="138.5" x2="300.5" y1="631.9688" y2="631.9688"/><ellipse cx="148.5" cy="643.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="157.5" y="646.1792">get_topic_name(): string</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="145.5" y="653.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="91" x="157.5" y="658.9839">validate_name()</text><!--class ServiceObject--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="57.5781" id="ServiceObject" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="336.5" y="608"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="383" y="624.1387">ServiceObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="337.5" x2="513.5" y1="631.9688" y2="631.9688"/><ellipse cx="347.5" cy="643.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="356.5" y="646.1792">get_service_name(): string</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="344.5" y="653.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="91" x="356.5" y="658.9839">validate_name()</text><!--class Publisher--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="44.7734" id="Publisher" style="stroke: #A80036; stroke-width: 1.5;" width="427" x="6" y="761.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="58" x="190.5" y="777.6387">Publisher</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="432" y1="785.4688" y2="785.4688"/><ellipse cx="17" cy="797.3711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="401" x="26" y="799.6792">publish(string message, optional&lt;EmailHeaders&gt; additional_headers)</text><!--class Subscription--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="91.1875" id="Subscription" style="stroke: #A80036; stroke-width: 1.5;" width="391" x="468" y="738.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="624.5" y="754.6387">Subscription</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="469" x2="858" y1="762.4688" y2="762.4688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="476" y="771.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="274" x="488" y="776.6792">messages: queue&lt;pair&lt;string, MessageInfo&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="469" x2="858" y1="783.2734" y2="783.2734"/><ellipse cx="479" cy="795.1758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="488" y="797.4839">has_message(): bool</text><ellipse cx="479" cy="807.9805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="488" y="810.2886">get_message(): optional&lt;string&gt;</text><ellipse cx="479" cy="820.7852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="365" x="488" y="823.0933">get_message_with_info(): optional&lt;pair&lt;string, MessageInfo&gt;&gt;</text><!--class ServiceClient--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="142.4063" id="ServiceClient" style="stroke: #A80036; stroke-width: 1.5;" width="509" x="658" y="896"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80" x="872.5" y="912.1387">ServiceClient</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="659" x2="1166" y1="919.9688" y2="919.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="666" y="928.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="389" x="678" y="934.1792">responses: map&lt;SequenceNumber, pair&lt;EmailData, ServiceInfo&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="659" x2="1166" y1="940.7734" y2="940.7734"/><ellipse cx="669" cy="952.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="301" x="678" y="954.9839">send_request(string request, SequenceNumber seq)</text><ellipse cx="669" cy="965.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="239" x="678" y="967.7886">send_request(request): SequenceNumber</text><ellipse cx="669" cy="978.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="678" y="980.5933">has_response(SequenceNumber seq): bool</text><ellipse cx="669" cy="991.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="678" y="993.3979">has_response(): bool</text><ellipse cx="669" cy="1003.8945" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="316" x="678" y="1006.2026">get_response(SequenceNumber seq): optional&lt;string&gt;</text><ellipse cx="669" cy="1016.6992" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="483" x="678" y="1019.0073">get_response_with_info(SequenceNumber seq): optional&lt;pair&lt;string, ServiceInfo&gt;&gt;</text><ellipse cx="669" cy="1029.5039" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="357" x="678" y="1031.812">get_response_with_info(): optional&lt;pair&lt;string, ServiceInfo&gt;&gt;</text><!--class ServiceServer--><rect fill="#FEFECE" filter="url(#f1gdedjht3erou)" height="103.9922" id="ServiceServer" style="stroke: #A80036; stroke-width: 1.5;" width="428" x="965.5" y="732"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="1137" y="748.1387">ServiceServer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="966.5" x2="1392.5" y1="755.9688" y2="755.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="973.5" y="764.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="280" x="985.5" y="770.1792">requests: queue&lt;pair&lt;EmailData, ServiceInfo&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="966.5" x2="1392.5" y1="776.7734" y2="776.7734"/><ellipse cx="976.5" cy="788.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="985.5" y="790.9839">has_request(): bool</text><ellipse cx="976.5" cy="801.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="235" x="985.5" y="803.7886">get_request(): optional&lt;ServiceRequest&gt;</text><ellipse cx="976.5" cy="814.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="402" x="985.5" y="816.5933">get_request_with_info(): optional&lt;pair&lt;ServiceRequest, ServiceInfo&gt;&gt;</text><ellipse cx="976.5" cy="827.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="357" x="985.5" y="829.3979">send_response(ServiceRequestId request_id, string response)</text><!--link CurlContext to CurlExecutor--><path d="M1057.5,104.29 C1057.5,120.27 1057.5,137.14 1057.5,150.8 " fill="none" id="CurlContext-CurlExecutor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1057.5,91.16,1053.5,97.16,1057.5,103.16,1061.5,97.16,1057.5,91.16" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CurlExecutor to EmailSender--><path d="M989.52,203.74 C955.31,218.02 915.31,239.41 887.5,269 C793.77,368.72 748.49,531.58 732.5,601.9 " fill="none" id="CurlExecutor-EmailSender" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="987.16,197.14,1008.33,196.34,992.28,210.17,987.16,197.14" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CurlExecutor to EmailReceiver--><path d="M1096.77,224.46 C1109.58,238.63 1123.87,254.44 1136.91,268.87 " fill="none" id="CurlExecutor-EmailReceiver" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1091.29,228.83,1083.08,209.3,1101.68,219.45,1091.29,228.83" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailReceiver to PollingManager--><path d="M1194.87,378.18 C1198.75,393.41 1202.92,409.73 1206.78,424.83 " fill="none" id="EmailReceiver-PollingManager" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="1191.54,365.14,1189.1472,371.9426,1194.5062,376.7676,1196.899,369.9651,1191.54,365.14" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailHandler to SubscriptionHandler--><path d="M1573.56,512.82 C1495.84,540.01 1379.1,580.86 1301.64,607.96 " fill="none" id="EmailHandler-SubscriptionHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1571.73,506.04,1592.92,506.05,1576.36,519.26,1571.73,506.04" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PollingManager to SubscriptionHandler--><path d="M1221.5,547.23 C1221.5,568.24 1221.5,590.63 1221.5,607.67 " fill="none" id="PollingManager-SubscriptionHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1221.5,542.21,1217.5,551.21,1221.5,547.21,1225.5,551.21,1221.5,542.21" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="1131.5859" y="561.9518">registers with</text><!--link EmailHandler to ServiceHandler--><path d="M1697.3,518.99 C1728.05,543.77 1769.31,577.02 1799.99,601.75 " fill="none" id="EmailHandler-ServiceHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1692.62,524.21,1681.44,506.21,1701.4,513.31,1692.62,524.21" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PollingManager to ServiceHandler--><path d="M1372.95,521.45 C1473.62,546.01 1604.84,578.02 1702.97,601.96 " fill="none" id="PollingManager-ServiceHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1367.88,520.21,1375.6746,526.2303,1372.7374,521.3958,1377.5719,518.4585,1367.88,520.21" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="1375.2581" y="518.4245">registers with</text><!--link GidObject to PubSubObject--><path d="M225.39,536.87 C223.97,560.76 222.35,588.09 221.16,607.99 " fill="none" id="GidObject-PubSubObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="218.42,536.18,226.59,516.63,232.39,537.01,218.42,536.18" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NamedObject to PubSubObject--><path d="M345.09,535.33 C314.92,559.51 280,587.51 254.65,607.83 " fill="none" id="NamedObject-PubSubObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="340.82,529.78,360.81,522.73,349.58,540.7,340.82,529.78" style="stroke: #A80036; stroke-width: 1.0;"/><!--link GidObject to ServiceObject--><path d="M286.39,529.02 C319.61,554.57 360.31,585.87 389.08,607.99 " fill="none" id="GidObject-ServiceObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="281.87,534.37,270.28,516.63,290.4,523.27,281.87,534.37" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NamedObject to ServiceObject--><path d="M415.04,542.79 C417.55,565.11 420.29,589.57 422.34,607.83 " fill="none" id="NamedObject-ServiceObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="408.06,543.39,412.79,522.73,421.98,541.82,408.06,543.39" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PubSubObject to Publisher--><path d="M219.5,686.66 C219.5,712.01 219.5,741.72 219.5,761.38 " fill="none" id="PubSubObject-Publisher" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="212.5,686.3,219.5,666.3,226.5,686.3,212.5,686.3" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailSender to Publisher--><path d="M593.9,675.71 C498.64,703.01 373.28,738.93 294.53,761.5 " fill="none" id="EmailSender-Publisher" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="606.55,672.09,599.682,669.8922,595.0117,675.3867,601.8797,677.5844,606.55,672.09" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PubSubObject to Subscription--><path d="M320.82,672.4 C397.8,697.86 465.83,719.86 523.58,738.4 " fill="none" id="PubSubObject-Subscription" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="318.38,678.96,301.6,666.03,322.78,665.67,318.38,678.96" style="stroke: #A80036; stroke-width: 1.0;"/><!--link SubscriptionHandler to Subscription--><path d="M1108.45,667.38 C1029.87,687.8 923.7,715.39 834.78,738.49 " fill="none" id="SubscriptionHandler-Subscription" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1113.58,666.04,1103.8625,664.4366,1108.7413,667.2998,1105.8782,672.1786,1113.58,666.04" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="997.5559" y="685.7005">registers with</text><!--link ServiceObject to ServiceClient--><path d="M529.76,671.32 C530.67,671.55 531.59,671.78 532.5,672 C683.24,708.92 767.86,621.17 876.5,732 C918.15,774.49 924.21,843.74 921.61,895.91 " fill="none" id="ServiceObject-ServiceClient" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="527.68,678.01,510.18,666.06,531.32,664.49,527.68,678.01" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Publisher to ServiceClient--><path d="M314.73,809.87 C402.98,832.92 538.25,868.25 657.82,899.48 " fill="none" id="Publisher-ServiceClient" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="302.06,806.56,306.8535,811.9472,313.67,809.5944,308.8765,804.2072,302.06,806.56" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServiceHandler to ServiceClient--><path d="M1773.22,674.44 C1689.36,717.46 1542.99,789.08 1411.5,836 C1333.3,863.91 1246.26,888.65 1167.05,908.87 " fill="none" id="ServiceHandler-ServiceClient" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1777.91,672.03,1768.0771,672.5904,1773.4639,674.3174,1771.7369,679.7042,1777.91,672.03" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="1671.8267" y="692.4454">registers with</text><!--link ServiceObject to ServiceServer--><path d="M528.92,671.16 C530.12,671.44 531.31,671.73 532.5,672 C710.22,713.09 758.97,699.77 938.5,732 C947.34,733.59 956.35,735.26 965.45,736.99 " fill="none" id="ServiceObject-ServiceServer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="526.84,677.85,509.26,666.02,530.38,664.3,526.84,677.85" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailSender to ServiceServer--><path d="M844.88,676.13 C898.33,693.2 962.15,713.58 1019.65,731.95 " fill="none" id="EmailSender-ServiceServer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="832.23,672.09,836.728,677.7263,843.6608,675.742,839.1627,670.1058,832.23,672.09" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServiceHandler to ServiceServer--><path d="M1681.75,673.16 C1595.18,692.09 1487.24,715.7 1393.63,736.17 " fill="none" id="ServiceHandler-ServiceServer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1686.64,672.09,1676.9921,670.1107,1681.7561,673.161,1678.7057,677.925,1686.64,672.09" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="1562.5879" y="692.5172">registers with</text><!--
@startuml

class CurlContext {
   +init()
   +fini()
   +get_handle(): CURL *
   +execute()
}
hide CurlContext fields
hide CurlContext circle

class CurlExecutor {
   +init()
   #init_options() {abstract}
   #context: CurlContext
}
hide CurlExecutor fields
hide CurlExecutor circle
CurlContext *- - CurlExecutor


class EmailSender {
   +send(EmailContent, optional<EmailHeaders>)
   +reply(EmailContent, EmailData, optional<EmailHeaders>)
   #init_options() {abstract}
}
hide EmailSender fields
hide EmailSender circle
CurlExecutor <|- - EmailSender

class EmailReceiver {
   +get_email(): optional<EmailData>
   #init_options() {abstract}
   -get_nextuid(): optional<int>
   -get_email_from_uid(int): optional<EmailData>
   -execute(optional<string>, url_options, optional<string> custom_request): optional<string>
}
hide EmailReceiver fields
hide EmailReceiver circle
CurlExecutor <|- - EmailReceiver


class PollingManager {
   -thread
   -handlers: vector<function<void (EmailData)>>
   -poll_thread()
   +start()
   +shutdown()
   +register_handler(function<void (EmailData)>)
}
EmailReceiver o- - PollingManager
hide PollingManager circle

abstract class EmailHandler {
   +handle(EmailData) {abstract}
}
hide EmailHandler fields
hide EmailHandler circle


class SubscriptionHandler {
   -subscriptions
   +register_subscription(string topic_name, queue<pair<string, MessageInfo>> message_queue)
   +handle(EmailData) {abstract}
}
hide SubscriptionHandler fields
hide SubscriptionHandler circle
EmailHandler <|- - SubscriptionHandler
PollingManager "registers with" <- - SubscriptionHandler

class ServiceHandler {
   -clients
   -servers
   +register_service_client(Gid, map<SequenceNumber, pair<EmailData, ServiceInfo>> response_map)
   +register_service_server(string service_name, queue<pair<EmailData, ServiceInfo>> request_queue)
   +handle(EmailData) {abstract}
}
hide ServiceHandler fields
hide ServiceHandler circle
EmailHandler <|- - ServiceHandler
PollingManager "registers with" <- - ServiceHandler


class GidObject {
   -gid: Gid
   +get_gid(): Gid
}
hide GidObject circle
class NamedObject {
   -object_name: string
   #get_object_name(): string
   #validate_name() {abstract}
}
hide NamedObject circle

class PubSubObject {
   +get_topic_name(): string
   -validate_name() {abstract}
}
hide PubSubObject fields
hide PubSubObject circle
GidObject <|- - PubSubObject
NamedObject <|- - PubSubObject

class ServiceObject {
   +get_service_name(): string
   -validate_name() {abstract}
}
hide ServiceObject fields
hide ServiceObject circle
GidObject <|- - ServiceObject
NamedObject <|- - ServiceObject


class Publisher {
   +publish(string message, optional<EmailHeaders> additional_headers)
}
hide Publisher fields
hide Publisher circle
PubSubObject <|- - Publisher
EmailSender o- - Publisher

class Subscription {
   -messages: queue<pair<string, MessageInfo>>
   +has_message(): bool
   +get_message(): optional<string>
   +get_message_with_info(): optional<pair<string, MessageInfo>>
}
hide Subscription circle
PubSubObject <|- - Subscription
SubscriptionHandler "registers with" <- - Subscription


class ServiceClient {
   -responses: map<SequenceNumber, pair<EmailData, ServiceInfo>>
   +send_request(string request, SequenceNumber seq)
   +send_request(request): SequenceNumber
   +has_response(SequenceNumber seq): bool
   +has_response(): bool
   +get_response(SequenceNumber seq): optional<string>
   +get_response_with_info(SequenceNumber seq): optional<pair<string, ServiceInfo>>
   +get_response_with_info(): optional<pair<string, ServiceInfo>>
}
hide ServiceClient circle
ServiceObject <|- - ServiceClient
Publisher *- - ServiceClient
ServiceHandler "registers with" <- - ServiceClient

class ServiceServer {
   -requests: queue<pair<EmailData, ServiceInfo>>
   +has_request(): bool
   +get_request(): optional<ServiceRequest>
   +get_request_with_info(): optional<pair<ServiceRequest, ServiceInfo>>
   +send_response(ServiceRequestId request_id, string response)
}
hide ServiceServer circle
ServiceObject <|- - ServiceServer
EmailSender *- - ServiceServer
ServiceHandler "registers with" <- - ServiceServer

@enduml

PlantUML version 1.2018.13(Mon Nov 26 17:11:51 UTC 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.11+9
Operating System: Linux
OS Version: 5.8.0-1039-azure
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>