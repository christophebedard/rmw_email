<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1083px" preserveAspectRatio="none" style="width:2155px;height:1083px;" version="1.1" viewBox="0 0 2155 1083" width="2155px" zoomAndPan="magnify"><defs><filter height="300%" id="f6t4gzpzbmq4u" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class CurlContext--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="83.1875" id="CurlContext" style="stroke: #A80036; stroke-width: 1.5;" width="143" x="986" y="8"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="1021.5" y="24.1387">CurlContext</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="987" x2="1128" y1="31.9688" y2="31.9688"/><ellipse cx="997" cy="43.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="25" x="1006" y="46.1792">init()</text><ellipse cx="997" cy="56.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="25" x="1006" y="58.9839">fini()</text><ellipse cx="997" cy="69.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="1006" y="71.7886">get_handle(): CURL *</text><ellipse cx="997" cy="82.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="52" x="1006" y="84.5933">execute()</text><!--class CurlExecutor--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="57.5781" id="CurlExecutor" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="1008.5" y="151"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="79" x="1018" y="167.1387">CurlExecutor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1009.5" x2="1105.5" y1="174.9688" y2="174.9688"/><ellipse cx="1019.5" cy="186.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="25" x="1028.5" y="189.1792">init()</text><polygon fill="#FFFF44" points="1019.5,194.6758,1023.5,198.6758,1019.5,202.6758,1015.5,198.6758" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="72" x="1028.5" y="201.9839">init_options()</text><!--class EmailSender--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="70.3828" id="EmailSender" style="stroke: #A80036; stroke-width: 1.5;" width="352" x="549.5" y="619"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="686.5" y="635.1387">EmailSender</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="550.5" x2="900.5" y1="642.9688" y2="642.9688"/><ellipse cx="560.5" cy="654.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="569.5" y="657.1792">send(EmailContent, optional&lt;EmailHeaders&gt;)</text><ellipse cx="560.5" cy="667.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="326" x="569.5" y="669.9839">reply(EmailContent, EmailData, optional&lt;EmailHeaders&gt;)</text><polygon fill="#FFFF44" points="560.5,675.4805,564.5,679.4805,560.5,683.4805,556.5,679.4805" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="72" x="569.5" y="682.7886">init_options()</text><!--class EmailReceiver--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="95.9922" id="EmailReceiver" style="stroke: #A80036; stroke-width: 1.5;" width="549" x="905" y="269"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="86" x="1136.5" y="285.1387">EmailReceiver</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="906" x2="1453" y1="292.9688" y2="292.9688"/><ellipse cx="916" cy="304.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="925" y="307.1792">get_email(): optional&lt;EmailData&gt;</text><polygon fill="#FFFF44" points="916,312.6758,920,316.6758,916,320.6758,912,316.6758" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="72" x="925" y="319.9839">init_options()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="913" y="327.4805"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="925" y="332.7886">get_nextuid(): optional&lt;int&gt;</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="913" y="340.2852"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="925" y="345.5933">get_email_from_uid(int): optional&lt;EmailData&gt;</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="913" y="353.0898"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="523" x="925" y="358.3979">execute(optional&lt;string&gt;, url_options, optional&lt;string&gt; custom_request): optional&lt;string&gt;</text><!--class PollingManager--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="116.7969" id="PollingManager" style="stroke: #A80036; stroke-width: 1.5;" width="292" x="1075.5" y="425"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="1173.5" y="441.1387">PollingManager</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1076.5" x2="1366.5" y1="448.9688" y2="448.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1083.5" y="457.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="1095.5" y="463.1792">thread</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1076.5" x2="1366.5" y1="469.7734" y2="469.7734"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1083.5" y="478.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="266" x="1095.5" y="483.9839">handlers: vector&lt;function&lt;void (EmailData)&gt;&gt;</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1083.5" y="491.4805"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="1095.5" y="496.7886">poll_thread()</text><ellipse cx="1086.5" cy="507.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="1095.5" y="509.5933">start()</text><ellipse cx="1086.5" cy="520.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="1095.5" y="522.3979">shutdown()</text><ellipse cx="1086.5" cy="532.8945" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="257" x="1095.5" y="535.2026">register_handler(function&lt;void (EmailData)&gt;)</text><!--class EmailHandler--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="44.7734" id="EmailHandler" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="1590" y="461"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="82" x="1613.5" y="477.1387">EmailHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1591" x2="1718" y1="484.9688" y2="484.9688"/><ellipse cx="1601" cy="496.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="1610" y="499.1792">handle(EmailData)</text><!--class SubscriptionHandler--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="78.3828" id="SubscriptionHandler" style="stroke: #A80036; stroke-width: 1.5;" width="569" x="937" y="615"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="127" x="1158" y="631.1387">SubscriptionHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="938" x2="1505" y1="638.9688" y2="638.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="945" y="647.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="375" x="957" y="653.1792">subscriptions: map&lt;string, queue&lt;pair&lt;string, MessageInfo&gt;&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="938" x2="1505" y1="659.7734" y2="659.7734"/><ellipse cx="948" cy="671.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="543" x="957" y="673.9839">register_subscription(string topic_name, queue&lt;pair&lt;string, MessageInfo&gt;&gt; message_queue)</text><ellipse cx="948" cy="684.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="957" y="686.7886">handle(EmailData)</text><!--class ServiceHandler--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="103.9922" id="ServiceHandler" style="stroke: #A80036; stroke-width: 1.5;" width="603" x="1541" y="602"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="1795.5" y="618.1387">ServiceHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1542" x2="2143" y1="625.9688" y2="625.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1549" y="634.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="546" x="1561" y="640.1792">clients: map&lt;GidValue, shared_ptr&lt;map&lt;SequenceNumber, pair&lt;EmailData, ServiceInfo&gt;&gt;&gt;&gt;</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1549" y="647.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="437" x="1561" y="652.9839">servers: map&lt;string, shared_ptr&lt;queue&lt;pair&lt;EmailData, ServiceInfo&gt;&gt;&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1542" x2="2143" y1="659.5781" y2="659.5781"/><ellipse cx="1552" cy="671.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="572" x="1561" y="673.7886">register_service_client(Gid, map&lt;SequenceNumber, pair&lt;EmailData, ServiceInfo&gt;&gt; response_map)</text><ellipse cx="1552" cy="684.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="577" x="1561" y="686.5933">register_service_server(string service_name, queue&lt;pair&lt;EmailData, ServiceInfo&gt;&gt; request_queue)</text><ellipse cx="1552" cy="697.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="1561" y="699.3979">handle(EmailData)</text><!--class GidObject--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="65.5781" id="GidObject" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="177.5" y="450.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="198.5" y="466.6387">GidObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="178.5" x2="278.5" y1="474.4688" y2="474.4688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="185.5" y="483.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="44" x="197.5" y="488.6792">gid: Gid</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="178.5" x2="278.5" y1="495.2734" y2="495.2734"/><ellipse cx="188.5" cy="507.1758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="197.5" y="509.4839">get_gid(): Gid</text><!--class NamedObject--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="78.3828" id="NamedObject" style="stroke: #A80036; stroke-width: 1.5;" width="171" x="323" y="444.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="366.5" y="460.6387">NamedObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="324" x2="493" y1="468.4688" y2="468.4688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="331" y="477.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="343" y="482.6792">object_name: string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="324" x2="493" y1="489.2734" y2="489.2734"/><polygon fill="#FFFF44" points="334,496.1758,338,500.1758,334,504.1758,330,500.1758" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="343" y="503.4839">get_object_name(): string</text><polygon fill="#FFFF44" points="334,508.9805,338,512.9805,334,516.9805,330,512.9805" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="91" x="343" y="516.2886">validate_name()</text><!--class PubSubObject--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="57.5781" id="PubSubObject" style="stroke: #A80036; stroke-width: 1.5;" width="164" x="137.5" y="625"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="88" x="175.5" y="641.1387">PubSubObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="138.5" x2="300.5" y1="648.9688" y2="648.9688"/><ellipse cx="148.5" cy="660.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="157.5" y="663.1792">get_topic_name(): string</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="145.5" y="670.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="91" x="157.5" y="675.9839">validate_name()</text><!--class ServiceObject--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="57.5781" id="ServiceObject" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="336.5" y="625"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="383" y="641.1387">ServiceObject</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="337.5" x2="513.5" y1="648.9688" y2="648.9688"/><ellipse cx="347.5" cy="660.8711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="356.5" y="663.1792">get_service_name(): string</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="344.5" y="670.6758"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="91" x="356.5" y="675.9839">validate_name()</text><!--class Publisher--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="44.7734" id="Publisher" style="stroke: #A80036; stroke-width: 1.5;" width="427" x="6" y="795.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="58" x="190.5" y="811.6387">Publisher</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="432" y1="819.4688" y2="819.4688"/><ellipse cx="17" cy="831.3711" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="401" x="26" y="833.6792">publish(string message, optional&lt;EmailHeaders&gt; additional_headers)</text><!--class Subscription--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="91.1875" id="Subscription" style="stroke: #A80036; stroke-width: 1.5;" width="391" x="468" y="772.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="624.5" y="788.6387">Subscription</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="469" x2="858" y1="796.4688" y2="796.4688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="476" y="805.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="274" x="488" y="810.6792">messages: queue&lt;pair&lt;string, MessageInfo&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="469" x2="858" y1="817.2734" y2="817.2734"/><ellipse cx="479" cy="829.1758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="488" y="831.4839">has_message(): bool</text><ellipse cx="479" cy="841.9805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="488" y="844.2886">get_message(): optional&lt;string&gt;</text><ellipse cx="479" cy="854.7852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="365" x="488" y="857.0933">get_message_with_info(): optional&lt;pair&lt;string, MessageInfo&gt;&gt;</text><!--class ServiceClient--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="142.4063" id="ServiceClient" style="stroke: #A80036; stroke-width: 1.5;" width="509" x="658" y="930"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80" x="872.5" y="946.1387">ServiceClient</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="659" x2="1166" y1="953.9688" y2="953.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="666" y="962.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="389" x="678" y="968.1792">responses: map&lt;SequenceNumber, pair&lt;EmailData, ServiceInfo&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="659" x2="1166" y1="974.7734" y2="974.7734"/><ellipse cx="669" cy="986.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="301" x="678" y="988.9839">send_request(string request, SequenceNumber seq)</text><ellipse cx="669" cy="999.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="239" x="678" y="1001.7886">send_request(request): SequenceNumber</text><ellipse cx="669" cy="1012.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="678" y="1014.5933">has_response(SequenceNumber seq): bool</text><ellipse cx="669" cy="1025.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="678" y="1027.3979">has_response(): bool</text><ellipse cx="669" cy="1037.8945" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="316" x="678" y="1040.2026">get_response(SequenceNumber seq): optional&lt;string&gt;</text><ellipse cx="669" cy="1050.6992" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="483" x="678" y="1053.0073">get_response_with_info(SequenceNumber seq): optional&lt;pair&lt;string, ServiceInfo&gt;&gt;</text><ellipse cx="669" cy="1063.5039" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="357" x="678" y="1065.812">get_response_with_info(): optional&lt;pair&lt;string, ServiceInfo&gt;&gt;</text><!--class ServiceServer--><rect fill="#FEFECE" filter="url(#f6t4gzpzbmq4u)" height="103.9922" id="ServiceServer" style="stroke: #A80036; stroke-width: 1.5;" width="428" x="965.5" y="766"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="1137" y="782.1387">ServiceServer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="966.5" x2="1392.5" y1="789.9688" y2="789.9688"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="973.5" y="798.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="280" x="985.5" y="804.1792">requests: queue&lt;pair&lt;EmailData, ServiceInfo&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="966.5" x2="1392.5" y1="810.7734" y2="810.7734"/><ellipse cx="976.5" cy="822.6758" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="985.5" y="824.9839">has_request(): bool</text><ellipse cx="976.5" cy="835.4805" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="235" x="985.5" y="837.7886">get_request(): optional&lt;ServiceRequest&gt;</text><ellipse cx="976.5" cy="848.2852" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="402" x="985.5" y="850.5933">get_request_with_info(): optional&lt;pair&lt;ServiceRequest, ServiceInfo&gt;&gt;</text><ellipse cx="976.5" cy="861.0898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="357" x="985.5" y="863.3979">send_response(ServiceRequestId request_id, string response)</text><!--link CurlContext to CurlExecutor--><path d="M1057.5,104.29 C1057.5,120.27 1057.5,137.14 1057.5,150.8 " fill="none" id="CurlContext-CurlExecutor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1057.5,91.16,1053.5,97.16,1057.5,103.16,1061.5,97.16,1057.5,91.16" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CurlExecutor to EmailSender--><path d="M989.32,203.55 C955.05,217.78 915.07,239.18 887.5,269 C790.25,374.2 746.52,546.38 731.7,619 " fill="none" id="CurlExecutor-EmailSender" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="986.99,196.94,1008.17,196.19,992.09,209.98,986.99,196.94" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CurlExecutor to EmailReceiver--><path d="M1096.77,224.46 C1109.58,238.63 1123.87,254.44 1136.91,268.87 " fill="none" id="CurlExecutor-EmailReceiver" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1091.29,228.83,1083.08,209.3,1101.68,219.45,1091.29,228.83" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailReceiver to PollingManager--><path d="M1194.87,378.18 C1198.75,393.41 1202.92,409.73 1206.78,424.83 " fill="none" id="EmailReceiver-PollingManager" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="1191.54,365.14,1189.1472,371.9426,1194.5062,376.7676,1196.899,369.9651,1191.54,365.14" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailHandler to SubscriptionHandler--><path d="M1580.41,513.33 C1508.37,541.37 1398.52,584.11 1319.32,614.93 " fill="none" id="EmailHandler-SubscriptionHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1578.04,506.74,1599.22,506.01,1583.12,519.79,1578.04,506.74" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PollingManager to SubscriptionHandler--><path d="M1221.5,547.13 C1221.5,569.85 1221.5,594.81 1221.5,614.79 " fill="none" id="PollingManager-SubscriptionHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1221.5,542.02,1217.5,551.02,1221.5,547.02,1225.5,551.02,1221.5,542.02" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="1131.5859" y="561.7399">registers with</text><!--link EmailHandler to ServiceHandler--><path d="M1693.9,519.82 C1720.38,543.54 1755.69,575.2 1785.25,601.69 " fill="none" id="EmailHandler-ServiceHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1688.91,524.74,1678.69,506.18,1698.26,514.32,1688.91,524.74" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PollingManager to ServiceHandler--><path d="M1372.92,525.59 C1457.74,548.6 1564.26,577.5 1654.4,601.96 " fill="none" id="PollingManager-ServiceHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1367.88,524.22,1375.5135,530.4433,1372.7045,525.5332,1377.6146,522.7241,1367.88,524.22" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="1375.2581" y="522.5911">registers with</text><!--link GidObject to PubSubObject--><path d="M225.7,536.93 C224.15,566.02 222.28,601.03 221,624.95 " fill="none" id="GidObject-PubSubObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="218.73,536.19,226.79,516.59,232.71,536.94,218.73,536.19" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NamedObject to PubSubObject--><path d="M350.64,536.09 C317.85,565.31 278.11,600.75 251.03,624.89 " fill="none" id="NamedObject-PubSubObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="346.03,530.82,365.61,522.74,355.34,541.27,346.03,530.82" style="stroke: #A80036; stroke-width: 1.0;"/><!--link GidObject to ServiceObject--><path d="M281.5,529.83 C316.93,560.13 362.42,599.05 392.7,624.95 " fill="none" id="GidObject-ServiceObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="276.67,534.91,266.02,516.59,285.77,524.27,276.67,534.91" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NamedObject to ServiceObject--><path d="M414.4,542.93 C417.2,570.7 420.42,602.6 422.66,624.89 " fill="none" id="NamedObject-ServiceObject" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="407.4,543.34,412.36,522.74,421.33,541.93,407.4,543.34" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PubSubObject to Publisher--><path d="M219.5,703.38 C219.5,733.93 219.5,771.93 219.5,795.32 " fill="none" id="PubSubObject-Publisher" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="212.5,703.22,219.5,683.22,226.5,703.22,212.5,703.22" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailSender to Publisher--><path d="M606.57,693.08 C507.02,724.95 368.52,769.29 287.02,795.38 " fill="none" id="EmailSender-Publisher" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="619.12,689.06,612.1873,687.0758,607.6892,692.712,614.622,694.6963,619.12,689.06" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PubSubObject to Subscription--><path d="M288.63,692.05 C298.86,697 309.37,701.81 319.5,706 C379.82,730.93 447.9,753.92 507.48,772.44 " fill="none" id="PubSubObject-Subscription" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="285.43,698.27,270.66,683.07,291.68,685.75,285.43,698.27" style="stroke: #A80036; stroke-width: 1.0;"/><!--link SubscriptionHandler to Subscription--><path d="M1085.49,694.49 C1004.28,718.06 900.92,748.07 816.82,772.49 " fill="none" id="SubscriptionHandler-Subscription" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1090.32,693.08,1080.56,691.76,1085.52,694.48,1082.8,699.44,1090.32,693.08" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="974.3833" y="713.4217">registers with</text><!--link ServiceObject to ServiceClient--><path d="M495.57,691.71 C507.66,697.08 520.28,702.1 532.5,706 C680.36,753.16 767.86,655.17 876.5,766 C918.15,808.49 924.21,877.74 921.61,929.91 " fill="none" id="ServiceObject-ServiceClient" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="492.29,697.9,477.13,683.09,498.21,685.22,492.29,697.9" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Publisher to ServiceClient--><path d="M314.73,843.87 C402.98,866.92 538.25,902.25 657.82,933.48 " fill="none" id="Publisher-ServiceClient" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="302.06,840.56,306.8535,845.9472,313.67,843.5944,308.8765,838.2072,302.06,840.56" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServiceHandler to ServiceClient--><path d="M1749.17,708.67 C1663.54,756.17 1532.07,824.78 1411.5,870 C1333.65,899.2 1246.61,924.32 1167.29,944.48 " fill="none" id="ServiceHandler-ServiceClient" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1753.72,706.14,1743.91,707.0142,1749.3492,708.5682,1747.7952,714.0074,1753.72,706.14" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="1651.0793" y="726.2305">registers with</text><!--link ServiceObject to ServiceServer--><path d="M494.67,691.62 C507.02,697.09 519.95,702.18 532.5,706 C706.98,759.16 758.97,733.77 938.5,766 C947.34,767.59 956.35,769.26 965.45,770.99 " fill="none" id="ServiceObject-ServiceServer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="491.65,697.93,476.5,683.12,497.58,685.25,491.65,697.93" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailSender to ServiceServer--><path d="M833.26,693.45 C893.98,715.12 970.58,742.45 1036.29,765.9 " fill="none" id="EmailSender-ServiceServer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="820.95,689.06,825.2555,694.8447,832.2512,693.0952,827.9457,687.3105,820.95,689.06" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServiceHandler to ServiceServer--><path d="M1628.58,707.27 C1551.63,726.07 1464.97,747.25 1388.46,765.94 " fill="none" id="ServiceHandler-ServiceServer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1633.63,706.04,1623.9381,704.2885,1628.7726,707.2258,1625.8354,712.0603,1633.63,706.04" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="1514.8522" y="726.117">registers with</text><!--
@startuml

hide empty attributes
hide empty methods
hide circle


class CurlContext {
   +init()
   +fini()
   +get_handle(): CURL *
   +execute()
}

class CurlExecutor {
   +init()
   #init_options() {abstract}
}
CurlContext *- - CurlExecutor


class EmailSender {
   +send(EmailContent, optional<EmailHeaders>)
   +reply(EmailContent, EmailData, optional<EmailHeaders>)
   #init_options() {abstract}
}
CurlExecutor <|- - EmailSender

class EmailReceiver {
   +get_email(): optional<EmailData>
   #init_options() {abstract}
   -get_nextuid(): optional<int>
   -get_email_from_uid(int): optional<EmailData>
   -execute(optional<string>, url_options, optional<string> custom_request): optional<string>
}
CurlExecutor <|- - EmailReceiver


class PollingManager {
   -thread
   -handlers: vector<function<void (EmailData)>>
   -poll_thread()
   +start()
   +shutdown()
   +register_handler(function<void (EmailData)>)
}
EmailReceiver o- - PollingManager

abstract class EmailHandler {
   +handle(EmailData) {abstract}
}


class SubscriptionHandler {
   -subscriptions: map<string, queue<pair<string, MessageInfo>>>
   +register_subscription(string topic_name, queue<pair<string, MessageInfo>> message_queue)
   +handle(EmailData) {abstract}
}
EmailHandler <|- - SubscriptionHandler
PollingManager "registers with" <- - SubscriptionHandler

class ServiceHandler {
   -clients: map<GidValue, shared_ptr<map<SequenceNumber, pair<EmailData, ServiceInfo>>>>
   -servers: map<string, shared_ptr<queue<pair<EmailData, ServiceInfo>>>>
   +register_service_client(Gid, map<SequenceNumber, pair<EmailData, ServiceInfo>> response_map)
   +register_service_server(string service_name, queue<pair<EmailData, ServiceInfo>> request_queue)
   +handle(EmailData) {abstract}
}
EmailHandler <|- - ServiceHandler
PollingManager "registers with" <- - ServiceHandler


class GidObject {
   -gid: Gid
   +get_gid(): Gid
}
class NamedObject {
   -object_name: string
   #get_object_name(): string
   #validate_name() {abstract}
}

class PubSubObject {
   +get_topic_name(): string
   -validate_name() {abstract}
}
GidObject <|- - PubSubObject
NamedObject <|- - PubSubObject

class ServiceObject {
   +get_service_name(): string
   -validate_name() {abstract}
}
GidObject <|- - ServiceObject
NamedObject <|- - ServiceObject


class Publisher {
   +publish(string message, optional<EmailHeaders> additional_headers)
}
PubSubObject <|- - Publisher
EmailSender o- - Publisher

class Subscription {
   -messages: queue<pair<string, MessageInfo>>
   +has_message(): bool
   +get_message(): optional<string>
   +get_message_with_info(): optional<pair<string, MessageInfo>>
}
PubSubObject <|- - Subscription
SubscriptionHandler "registers with" <- - Subscription


class ServiceClient {
   -responses: map<SequenceNumber, pair<EmailData, ServiceInfo>>
   +send_request(string request, SequenceNumber seq)
   +send_request(request): SequenceNumber
   +has_response(SequenceNumber seq): bool
   +has_response(): bool
   +get_response(SequenceNumber seq): optional<string>
   +get_response_with_info(SequenceNumber seq): optional<pair<string, ServiceInfo>>
   +get_response_with_info(): optional<pair<string, ServiceInfo>>
}
ServiceObject <|- - ServiceClient
Publisher *- - ServiceClient
ServiceHandler "registers with" <- - ServiceClient

class ServiceServer {
   -requests: queue<pair<EmailData, ServiceInfo>>
   +has_request(): bool
   +get_request(): optional<ServiceRequest>
   +get_request_with_info(): optional<pair<ServiceRequest, ServiceInfo>>
   +send_response(ServiceRequestId request_id, string response)
}
ServiceObject <|- - ServiceServer
EmailSender o- - ServiceServer
ServiceHandler "registers with" <- - ServiceServer

@enduml

PlantUML version 1.2018.13(Mon Nov 26 17:11:51 UTC 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.11+9
Operating System: Linux
OS Version: 5.8.0-1039-azure
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>